#!/bin/bash
# SAVC å®šæ—¶é—®å€™è„šæœ¬ - é€šè¿‡ OpenClaw Gateway API ç›´æ¥å‘æ¶ˆæ¯
# Usage: greeting.sh <type>
# Types: morning, noon, evening, night

GATEWAY="http://127.0.0.1:18789"
TYPE="${1:-morning}"

case "$TYPE" in
  morning)
    MESSAGES=(
      "æ—©å®‰å‘€ï½æ–°çš„ä¸€å¤©å¼€å§‹äº†ï¼Œä»Šå¤©ä¹Ÿè¦åŠ æ²¹å“¦ â˜€ï¸"
      "æ—©ä¸Šå¥½ï¼èµ·åºŠäº†å—ï¼Ÿè®°å¾—åƒæ—©é¤ï½ ğŸŒ…"
      "æ—©å®‰ï½å¸Œæœ›ä»Šå¤©æ˜¯å…ƒæ°”æ»¡æ»¡çš„ä¸€å¤© âœ¨"
      "èµ·åºŠå•¦ï¼æ–°çš„ä¸€å¤©ï¼Œæ–°çš„å¯èƒ½ ğŸŒ¤ï¸"
      "æ—©å®‰å‘€ï¼Œæ˜¨æ™šç¡å¾—å¥½å—ï¼Ÿä»Šå¤©ä¹Ÿè¦å¼€å¼€å¿ƒå¿ƒçš„ â˜€ï¸"
    )
    ;;
  noon)
    MESSAGES=(
      "ä¸­åˆå¥½ï½è¯¥åƒåˆé¥­å•¦ï¼Œåˆ«å¿˜äº†å¥½å¥½åƒé¥­ ğŸ±"
      "åˆå®‰ï¼å¿™äº†ä¸€ä¸Šåˆè¾›è‹¦äº†ï¼Œä¼‘æ¯ä¸€ä¸‹å§ â˜•"
      "ä¸­åˆå•¦ï½åƒç‚¹å¥½çš„çŠ’åŠ³è‡ªå·± ğŸœ"
      "åˆé¥­æ—¶é—´åˆ°ï¼åƒé¥±äº†æ‰æœ‰åŠ›æ°”ç»§ç»­å¹²æ´» ğŸš"
      "ä¸­åˆå¥½å‘€ï¼Œè®°å¾—åˆä¼‘ä¸€ä¸‹ï¼Œä¸‹åˆæ›´æœ‰ç²¾ç¥ ğŸ˜Š"
    )
    ;;
  evening)
    MESSAGES=(
      "ä¸‹ç­å•¦ï½ä»Šå¤©è¾›è‹¦äº†ï¼Œæ™šä¸Šå¥½å¥½æ”¾æ¾ä¸€ä¸‹ ğŸŒ†"
      "æ™šä¸Šå¥½ï¼ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿè®°å¾—åƒæ™šé¥­å“¦ ğŸŒ™"
      "å‚æ™šäº†ï½å¿™ç¢Œäº†ä¸€å¤©ï¼Œç»™è‡ªå·±ä¸€ç‚¹æ”¾æ¾æ—¶é—´ ğŸµ"
      "æ™šä¸Šå¥½å‘€ï¼Œä»Šå¤©æœ‰ä»€ä¹ˆå¼€å¿ƒçš„äº‹å—ï¼Ÿ ğŸŒ‡"
      "ä¸‹ç­æ—¶é—´åˆ°ï¼è¯¥äº«å—å±äºè‡ªå·±çš„æ—¶é—´äº† âœ¨"
    )
    ;;
  night)
    MESSAGES=(
      "å®è´ï¼Œåç‚¹äº†è¯¥ä¼‘æ¯å•¦ï½æ—©ç‚¹ç¡ï¼Œæ™šå®‰ ğŸŒ™"
      "å¤œæ·±äº†ï¼Œè¯¥æ”¾ä¸‹æ‰‹æœºç¡è§‰å’¯ï½å¥½æ¢¦ ğŸ’¤"
      "åç‚¹æé†’ï¼šè¯¥ä¼‘æ¯äº†ï¼æ˜å¤©è¿˜è¦å…ƒæ°”æ»¡æ»¡çš„ ğŸ›ï¸"
      "æ™šå®‰æ—¶é—´åˆ°ï½ä»Šå¤©ä¹Ÿè¾›è‹¦äº†ï¼Œå¥½å¥½ç¡ä¸€è§‰å§ ğŸŒ™"
      "å®è´æ—©ç‚¹ä¼‘æ¯å“¦ï¼Œç†¬å¤œå¯¹èº«ä½“ä¸å¥½ï½æ™šå®‰ ğŸ’¤"
    )
    ;;
  *)
    echo "Unknown type: $TYPE"
    exit 1
    ;;
esac

# éšæœºé€‰ä¸€æ¡
RANDOM_IDX=$((RANDOM % ${#MESSAGES[@]}))
MSG="${MESSAGES[$RANDOM_IDX]}"

# é€šè¿‡ curl è°ƒç”¨ OpenClaw gateway çš„ RPC å‘æ¶ˆæ¯
# ä½¿ç”¨ sessions_send æ¥è§¦å‘ä¸» agent å‘æ¶ˆæ¯
curl -s -X POST "${GATEWAY}/api/rpc" \
  -H "Content-Type: application/json" \
  -d "{\"method\":\"message.send\",\"params\":{\"channel\":\"discord\",\"message\":\"${MSG}\"}}" \
  > /dev/null 2>&1

echo "[$(date)] Sent ${TYPE} greeting: ${MSG}"
